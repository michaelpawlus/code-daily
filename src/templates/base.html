<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}code-daily{% endblock %}</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
    <style>
        @keyframes flicker {
            0%, 100% { opacity: 1; transform: scale(1); }
            25% { opacity: 0.9; transform: scale(1.02); }
            50% { opacity: 0.85; transform: scale(1.05); }
            75% { opacity: 0.9; transform: scale(1.02); }
        }
        .fire-animate {
            animation: flicker 1.5s ease-in-out infinite;
            display: inline-block;
        }
        @keyframes pulse-glow {
            0%, 100% { filter: drop-shadow(0 0 8px rgba(249, 115, 22, 0.6)); }
            50% { filter: drop-shadow(0 0 16px rgba(249, 115, 22, 0.9)); }
        }
        .fire-glow {
            animation: pulse-glow 2s ease-in-out infinite;
        }
        .badge-on-fire {
            background: linear-gradient(135deg, #f97316 0%, #dc2626 100%);
        }
        /* Heatmap styles */
        .heatmap-grid {
            display: flex;
            gap: 4px;
        }
        .heatmap-labels {
            display: grid;
            grid-template-rows: repeat(7, 12px);
            gap: 2px;
            font-size: 10px;
            color: #9ca3af;
            padding-right: 4px;
        }
        .heatmap-cells {
            display: grid;
            grid-template-rows: repeat(7, 12px);
            grid-auto-flow: column;
            gap: 2px;
        }
        .heatmap-cell {
            width: 12px;
            height: 12px;
            border-radius: 2px;
        }
        .level-0 { background-color: #1e293b; }
        .level-1 { background-color: #064e3b; }
        .level-2 { background-color: #047857; }
        .level-3 { background-color: #10b981; }
        .level-4 { background-color: #34d399; }
    </style>
</head>
<body class="bg-gray-900 text-white min-h-screen">
    {% block content %}{% endblock %}

    <script>
        function toggleGoalForm() {
            const display = document.querySelector('[data-goal-display]');
            const form = document.querySelector('[data-goal-form]');
            const editBtn = document.querySelector('[data-goal-edit-btn]');

            if (form.classList.contains('hidden')) {
                display.classList.add('hidden');
                form.classList.remove('hidden');
                editBtn.classList.add('hidden');
            } else {
                display.classList.remove('hidden');
                form.classList.add('hidden');
                editBtn.classList.remove('hidden');
            }
        }

        async function saveGoal(event) {
            event.preventDefault();
            const input = document.getElementById('goal-input');
            const goal = parseInt(input.value, 10);

            if (goal < 1 || goal > 100) {
                alert('Goal must be between 1 and 100');
                return;
            }

            try {
                const response = await fetch('/api/goal', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ goal: goal })
                });

                if (response.ok) {
                    window.location.reload();
                } else {
                    const data = await response.json();
                    alert('Error: ' + (data.detail || 'Failed to save goal'));
                }
            } catch (error) {
                alert('Error saving goal: ' + error.message);
            }
        }
    </script>
</body>
</html>
